CREATE OR REPLACE TRIGGER P_INSCRIPTION_ARCHIVE
BEFORE INSERT OR DELETE OR UPDATE ON P_INSCRIPTION
FOR EACH ROW
BEGIN
  IF INSERTING THEN INSERT  INTO P_INSCRIPTION_ARCHIVE VALUES (P_SEQ_INSC_ARCH.nextval,
    :New.NOAUDITEUR,:NEW.NOATEL,:NEW.DATEINSCRIPTION,:NEW.MODE_PAIEMENT,:NEW.NO_CARTE,
    :NEW.NO_CHEQUE,:NEW.DATE_EXPIRE,:NEW.ACQUITTER,:NEW.CONFIRMATIONENVOYEE,'AJOUT',sysdate,:NEW.CREEPAR);
  END IF;
  IF UPDATING THEN INSERT INTO P_INSCRIPTION_ARCHIVE VALUES (P_SEQ_INSC_ARCH.nextval,
    :New.NOAUDITEUR,:NEW.NOATEL,:NEW.DATEINSCRIPTION,:NEW.MODE_PAIEMENT,:NEW.NO_CARTE,
    :NEW.NO_CHEQUE,:NEW.DATE_EXPIRE,:NEW.ACQUITTER,:NEW.CONFIRMATIONENVOYEE,'MODIFICATION',sysdate,:NEW.CREEPAR);
  END IF;
  IF DELETING THEN INSERT INTO P_INSCRIPTION_ARCHIVE VALUES (P_SEQ_INSC_ARCH.nextval,
    :OLD.NOAUDITEUR,:OLD.NOATEL,:OLD.DATEINSCRIPTION,:OLD.MODE_PAIEMENT,:OLD.NO_CARTE,
    :OLD.NO_CHEQUE,:OLD.DATE_EXPIRE,:OLD.ACQUITTER,:OLD.CONFIRMATIONENVOYEE,'ajout',sysdate,:OLD.CREEPAR);
  END IF;
END;

_____________
CREATE OR REPLACE TRIGGER P_MONEXPOSANT_TRG 
BEFORE INSERT ON P_EXPOSANT 
for each row
declare 
nom varchar2(20);
prenom varchar2(20);
code varchar2(20);
deconte number(3);
begin
  nom:=UPPER(:NEW.NOM);
  prenom:=UPPER(:NEW.PRENOM);
  if length(nom)<4
  then
    nom:=nom||'XXXX';
  end if;
  if length(prenom)<4
  then
    prenom:=prenom||'XXXX';
  end if;
  code:=(substr(nom,0,4)||substr(prenom,0,4));

select count(*) INTO deconte from E_ELEVES where substr(code_etudiant,0,8)=code;
deconte:=deconte+1;
code:=code||deconte;
:NEW.CODEETU:=code;
END;
/